/**
 * skylark-domx-carets - The skylark carets library for dom api extension.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-data"],function(t,e,n,r){"use strict";var a=/\r/g;function s(t,e){var n=r.val(t).replace(a,"").length;return void 0===e&&(e=n),(e=Math.floor(e))<0&&(e=n+e),e<0&&(e=0),e>n&&(e=n),e}var i=function(t,e,n,r){this.start=t||0,this.end=e||0,this.length=n||0,this.text=r||""};function l(t){if(t)return t.selectionStart}function o(t,e){return t.focus(),e=s(t,e),t.setSelectionRange(e,e),this}function u(t,e){var n=_getCaret(t),s=r.val(t).replace(a,""),i=+(n+e.length+(s.length-n)),l=+t.getAttribute("maxlength");if(_hasAttr(t,"maxlength")&&i>l){var u=e.length-(i-l);e=e.substr(0,u)}return r.val(t,s.substr(0,n)+e+s.substr(n)),o(t,n+e.length),this}function c(t){if(t){var e=new i;e.start=t.selectionStart,e.end=t.selectionEnd;var n=Math.min(e.start,e.end),a=Math.max(e.start,e.end);return e.length=a-n,e.text=r.val(t).substring(n,a),e}}function g(t,e,n){return e=s(t,e),n=s(t,n),t.setSelectionRange(e,n),this}function h(t,e){var n=r.val(t),a=c(t),s=+(a.start+e.length+(n.length-a.end)),i=+r.attr(t,"maxlength");if(i&&s>i){var l=e.length-(s-i);e=e.substr(0,l)}var o=n.substr(0,a.start),u=n.substr(a.end);r.val(t,o+e+u);var h=a.start,d=h+e.length;return g(t,a.length?h:d,d),this}function d(){return d}return i.prototype.toString=function(){return JSON.stringify(this,null,"    ")},e.mixin(d,{getCaret:l,setCaret:o,insertAtCaret:u,getInputRange:c,setInputRange:g,replaceInputRange:h,selectAll:function(t){if(t.select)return t.select(),this;var e=window.getSelection(),n=document.createRange();return n.selectNodeContents(t),e.removeAllRanges(),e.addRange(n),this},deselectAll:function(){return document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this},caret:function(t,e){return void 0===e?l(t):("number"==typeof e?o(t,e):u(t,e),this)},range:function(t,e,n){return void 0===e?c(t):("number"==typeof e?g(t,e,n):h(t,e),this)}}),t.attach("domx.carets",d)});
//# sourceMappingURL=sourcemaps/carets.js.map
